## 解决的问题有
以 $R(u,v)$ 表示由 $u,v$ 和常数通过有限四则运算的二元函数，我们解决 $R(\sin x,\cos x)$ 的三角有理函数。
如 $\frac{1}{1+\cos x}$, $\frac{\sin x}{\cos ^{2}x}$, $\frac{1}{(\sin x+\cos x)^{2}}$ 等问题

## 万能公式
所有三角有理函数都可以通过换元 $t=\tan \frac{x}{2}$ 进行万能代换转化为[[有理函数积分]].
$x=2\arctan t$, 所以 $\mathrm{d}x=\frac{2}{1+x^{2}}\mathrm{d}t$.
同时，我们的 $\sin x,\cos x$ 都可以解决.
$$\sin x=2\sin \frac{x}{2}\cos \frac{x}{2}= \frac{\left( 2\sin \frac{x}{2}\cos \frac{x}{2} \right)}{\sin ^{2} \frac{x}{2}+\cos ^{2} \frac{x}{2}}=\frac{2t}{t^{2}+1}$$
$$
\cos x =\frac{\cos ^{2} \frac{x}{2}-\sin ^{2} \frac{x}{2}}{\sin ^{2} \frac{x}{2 } + \cos ^{2} \frac{x}{2}}=\frac{1-t^{2}}{1+t^{2}}
$$
化一下，然后用 $t=\tan \frac{x}{2}$ **回代**即可.

1.1 $\int \frac{1}{3+5\cos x}$
令 $t=\tan \frac{x}{2}$. 此时：$\cos x=\frac{1-t^{2}}{1+t^{2}}$ $\mathrm{d}x=\frac{2}{1+t^{2}}\mathrm{d}t$.
$$
I=\int \frac{1}{3+\frac{5(1-t^{2})}{1+t^{2}}} \frac{2}{1+t^{2}}\mathrm{d}t
$$
我们不难发现，右边的 $1+t^{2}$ 能够和左边的下面分式抵消了
$$
I=\int \frac{2}{3(1+t^{2})+5(1-t^{2})}=\int \frac{1}{4-t^{2}}\mathrm{d}t
$$
化简到这里，我们能够看到 $\frac{1}{a^{2}-x^{2}}$ 的形式，[[数学笔记#^0e1ac9|积分表]]中查询得到
$$
I=\frac{1}{4}\ln \frac{2-t}{2+t}
$$

1.2 $\int \frac{1}{1+\sin x+\cos x}$
$$
I=\int \frac{1}{1+\frac{2t}{1+t^{2}}+\frac{1-t^{2}}{1+t^{2}}} \frac{2}{1+t^{2}}
=\frac{2}{1+t^{2}+2t+1-t^{2}}=\frac{1}{1+t}\mathrm{d}t=\ln|1+t|+C
$$
然后回代即可.
> [!Warning]
> 三角函数积分如果被积分函数 $\sin x,\cos x$**次方太高**，因为本身换元后次数就有了不少上升，所以不建议使用换元法在这个时候.
> 比如说三角函数中次方 $\geq {3}$ 了就不建议使用.



## 技巧一：缩分母
### 适用范围
分母为 $1+\cos x$, $1-\cos x$ 的积分应该同时×共轭表达式.
> [!Quote]
> 我们对于不定积分，宁愿分子有很多项，也不愿意分母有很多项，分子我们可以拆成很多项解决

当然，我们也可以利用到[[数学笔记#二倍角公式]]来把分母项缩小.
2.1 $\int \frac{1}{1+\cos x}$
法一：×共轭表达式
$$
I=\frac{1-\cos x}{\sin ^{2}x}=\int \csc ^{2}x-\frac{\cos x}{\sin ^{2}x}=-\cot x+\csc x+C
$$
法二：二倍角
$1+\cos x=2 \cos ^{2} \frac{x}{2}$ ，自变量尽量统一 $\mathrm{d}\left( \frac{x}{2} \right)$ ，变为
$$
I=2\int \frac{\mathrm{d}\left( \frac{x}{2} \right)}{2\cos  ^{2} \frac{x}{2}}=\tan \frac{x}{2}+C
$$
法三：万能公式

2.2 $\int \frac{\sin x}{1+\sin x}\mathrm{d}x$
我们还可以利用 2.1 的结论，化归：$\int \frac{(\sin x+1)-1}{1+\sin x}=1-\frac{1}{1+\sin x}$
想到诱导公式：$\int 1-\frac{1}{1+\cos\left( \frac{\pi}{2}-x \right)}=1-\frac{1}{1+\cos\left( x-\frac{\pi}{2} \right)}=x-\tan \left( \frac{\left( x-\frac{\pi}{2} \right)}{2} \right)+C$.

2.3 $\int \frac{1}{\sin x+\cos x}\mathrm{d}x$
我们尝试刚刚那样：
$$
\int \frac{\cos x-\sin x}{\cos ^{2}-\sin ^{2}x}=\int \frac{\cos x-\sin x}{\cos 2x}\mathrm{d}x
$$
我们发现很难做，绕弯了. (但也可以做，考虑接下来的做法)
本题我们可以用**辅助角公式（本身就是用于合并三角函数的）**
 $\sin x+\cos x=\sqrt{ 2 }\sin\left( x+\frac{\pi}{4} \right)$.
这个时候算起来就简单很多
## 法二：凑 $\mathrm{d}(\sin x)$
### 使用范围
$R(\sin x,-\cos x)=-R(\sin x,\cos x)$ 的时候，我的理解：
每一个 $\cos x$ 前面加一个负号，看看是不是原来函数的相反数
3.1 $\int \frac{1}{\sin ^{2}x \cos x}\mathrm{d}x$
解法：
$$
原式=\int \frac{\cos x}{\sin ^{2}x \cos ^{2}x}=\frac{\mathrm{d}(\sin x)}{\sin ^{2}x(1-\sin ^{2}x)}
$$
令 $t=\sin x$, 即 $\int \frac{\mathrm{d}t}{t^{2}(1-t^{2})}=\frac{(1-t^{2})+t^{2}}{t^{2}(1-t^{2})}=\frac{1}{1-t^{2}}+\frac{1}{t^{2}}$

3.2 $\int \frac{\cos ^{3}x-2\cos x}{1+\sin^2+\sin^4}\mathrm{d}x$
$$
\begin{align}
原式=\int \frac{\cos ^{2}x-2}{1+\sin ^{2}x+\sin^4}\mathrm{d}(\sin x)\\ \\
=-\int \frac{1+\sin ^{2}x}{1+\sin ^{2}x+\sin^4x}d(\sin x)\\ \\
\end{align}
$$
令 $t=\sin x$，原式= $-\int \frac{1+t^{2}}{1+t^{2}+t^4}\mathrm{d}t$.
这道题，我们可以回顾[[有理函数积分#^b221e3|有理函数特解]]继续解决问题.

3.3 $\int \sec ^{3}\mathrm{d}x$
$$
原式=\int \frac{1}{\cos ^{3}x}=\frac{\mathrm{d}(\sin x)}{\cos^4x}=\frac{\mathrm{d}(\sin x)}{(1-\sin ^{2}x)^2}
$$
再次换元得到结果.

方法二：积分重现+分部积分 ^53 e 315
$$
I=\sec^3 \mathrm{d}x=\sec x \mathrm{d}(\tan x)=\tan x \sec x- \int \tan x \mathrm{d}(\sec x)
$$
接着：$\int \tan x \mathrm{d}(\sec x)=\int \tan ^{2}x \sec x\mathrm{d}x=\int(\sec ^{2}x-1)\sec \mathrm{d}x$
我们回到了前面的 $I-\sec \mathrm{d}x$

3.4 $\int \sqrt{ 1+x^{2} }\mathrm{d}x$
令 $x=\tan t$, 原式= $\int \sec t\sec ^{2}t=\sec ^{3}t\mathrm{d}t$ 
有的时候我们没必要把 $dx$ 替换.
$$
原式=\int \sec t \mathrm{d}(\tan t)=\sec t\tan t-\int \tan t \sec t \tan t \mathrm{d}t
$$
方法二：直接使用分部积分.

## 法三 ：探索题
$\int \sec x=\ln|\sec x+\tan x|+C$ 和 $\int \sec ^{2}x=\tan x+C$ 是基本的积分公式.
$$
I_{n}=\int \sec^n\mathrm{d}x
$$
$$
I_{4}=\int \sec ^{2}\mathrm{d}(\tan x)=\int(\tan ^{2}x-1)\mathrm{d}(\tan x)
$$
$$
I_{5}=\int \sec^5\mathrm{d} x=\int \sec ^{3}\mathrm{d}(\tan x)
$$
回到上面的方法：[[#^53e315|分部积分+积分重现]].
